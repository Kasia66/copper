<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta name="generator" content="Hugo 0.37.1" />
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> Getting Started </title>

  
  <meta name="description" content="Taking the first steps to validate your Kubernetes configuration files"> 
  
  
  
  
  

  

  <meta name="author" content="Cloud 66">


  <meta property="og:title" content="Getting Started" />
<meta property="og:description" content="Taking the first steps to validate your Kubernetes configuration files" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://copper.sh/docs/getting-started/" />



<meta property="article:published_time" content="2018-03-19T10:52:22&#43;00:00"/>

<meta property="article:modified_time" content="2018-03-19T10:52:22&#43;00:00"/>











  




  
  
  
  
  

  <link rel="canonical" href="http://copper.sh/docs/getting-started/">  

  <link rel="shortcut icon" type="image/png" href="data:image/x-icon;base64,AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAAMMOAADDDgAAAAAAAAAAAAD///////////////////////////////////////////////////////////////////7/+/Hp//LOsP/op3D/6Khy//PQsf/88ur/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+/Ho//HJp//no2n/45JN/+KPSP/ij0j/45JN/+ekav/xy6r/+/Lq/////////////////////////////////////////////////////////////////////////////////////////////////////////////ffy//LOsP/moWb/4o9J/+KPSP/ikEr/4pBK/+KQSv/ikEr/4o9I/+KQSf/no2j/89Gz//348/////////////////////////////////////////////////////////////////////////////////////////7+//jk0v/qrXn/4pFL/+KPSP/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KPSP/jkUz/6q99//jm1v////7///////////////////////////////////////////////////////////////////////76+P/yzq7/5ZpZ/+KOR//ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ijkj/5Ztc//PRs//++/n////////////////////////////////////////////////////////////99/H/7r6V/+OSTf/ij0n/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ij0n/45NP/+/Bmv/9+PT//////////////////////////////////////////////////PXw/+y3iv/ikEr/4pBJ/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBJ/+KQSf/ikEn/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEn/4pBK/+27j//99/L///////////////////////////////////////359f/tuo7/4o9J/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ijkj/4o9I/+KSTf/klVP/5JdV/+SWU//ikk3/4o9I/+KOSP/ikEr/4pBK/+KQSv/ikEr/4pBK/+6+lf/++vf//////////////////////////////fz/8Mej/+KRS//ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ij0j/45RR/+mseP/xyab/9tzG//jm1v/56dv/+ObW//bcxv/xyKX/6ax3/+OVUv/ikEr/4pBK/+KQSv/ikEn/45FN//LLq////v7///////////////////////bdyP/kllT/4o9J/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9J/+mpc//23cj//vr2///////////////////////////////////////++vf/9NW6/+OVUf/ikEn/4pBK/+KQSv/ij0n/5JhX//fhz//////////////////99vD/6alz/+KPSP/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSf/stYb//PPr///////////////////////////////////////////////////////66t3/5JhX/+KPSf/ikEr/4pBK/+KQSv/ij0f/6q16//348/////////////PStf/ikUv/4pBK/+KQSv/ikEr/4pBK/+KQSv/ij0j/6at1//zz6////////////////////v3/+enc//LMq//uvZT/7r6V//HLqv/349H//vv4//rq3f/kmFf/4pBJ/+KQSv/ikEr/4pBK/+KQSv/jkk3/9Ne9///////99/L/6ap1/+KPSP/ikEr/4pBK/+KQSv/ikEr/4pBJ/+SWU//338v//////////////////v37//LOsP/lmlv/4o9I/+KOR//ijkf/4o9I/+OVUv/qsH3/8cuq/+SXVv/ikEn/4pBK/+KQSv/ikEr/4pBK/+KOR//qr33//vn2//beyf/kllP/4pBJ/+KQSv/ikEr/4pBK/+KQSv/ijkf/6q98//76+P/////////////////12sP/45VS/+KPSP/ikEr/4pBK/+KQSv/ikEr/4pBJ/+KPSP/jkk7/4pFL/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBJ/+SYV//45NL/78CY/+KQSf/ikEr/4pBK/+KQSv/ikEr/4pBK/+KPSP/xy6r//////////////////vr3/+que//ijkf/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK//DHpP/oqXL/4o9I/+KQSv/ikEr/4pBK/+KQSv/ikEr/45JN//bdx//////////////////67eL/5Zpa/+KPSf/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ij0j/6q98/+WaW//ij0n/4pBK/+KQSv/ikEr/4pBK/+KQSv/jlVL/+OXU//////////////////jj0v/jlFH/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KPSf/moGP/45NP/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBJ/+OVU//45tb/////////////////9+LQ/+OUUP/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBJ/+SYV//ikEv/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/45NP//fgzP/////////////////56dz/5JhW/+KQSf/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/45VT/+OTTv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/89G1//////////////////338f/opm3/4o9I/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSf/kl1b/5JlZ/+KQSf/ikEr/4pBK/+KQSv/ikEr/4pBK/+KOR//suIv///39//////////////////HLq//ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9J/+KPSP/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9J/+aeYf/opWz/4o9J/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9J/+WbXf/6697//////////////////ffy/+y4i//ikUv/4o5H/+KPSP/ij0j/4o5H/+KPSP/lnF3/7LWH/+OVU//ikEn/4pBK/+KQSv/ikEr/4pBK/+KQSv/ij0j/6ax3/+25jP/ij0n/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9I/+26j//++/n//////////////////fjz//PRtP/qsH7/56Rr/+eka//qr33/8cil//rs4P/56dv/5JhX/+KPSf/ikEr/4pBK/+KQSv/ikEr/4pBK/+KPSf/uv5j/89K1/+OSTf/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/45NP//HKqf/+/Pr///////////////////////78+v/99/L//ffy//78+v////////////rq3f/kmFf/4o9J/+KQSv/ikEr/4pBK/+KQSv/ikEr/45NP//XYwP/6697/5Zxd/+KPSf/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEn/45NP/+7AmP/88un/////////////////////////////////////////////////+OPS/+SWVP/ikEn/4pBK/+KQSv/ikEr/4pBK/+KPSP/moGP/++/l//78+f/rs4P/4o5H/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEn/4o9J/+eiaP/wx6P/+OTS//zy6v/9+PT//vr2//349P/88ur/+OPR//DGov/no2j/4pBL/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o5H/+25jP///fz///////TUuv/ikUv/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9I/+KPSP/jlVL/5p9i/+imbv/pqXP/6Kdv/+aeYf/jlVL/4o9I/+KPSP/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/jkk7/9drD/////////////PPr/+eiZ//ij0j/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ij0j/4o9I/+KOSP/ij0j/4o9J/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9I/+imbv/99vD/////////////////8cek/+KPSf/ikEr/4pBK/+KQSv/ikEr/4o9J/+KPSf/ij0n/4pBJ/+KQSv/ikEr/4pBK/+KQSv/ikEr/4pBK/+KQSv/ikEr/4o9J/+KPSf/ij0n/4o9J/+KQSv/ikEr/4pBK/+KQSv/ikEr/8s2u///////////////////////77uT/5p9i/+KPR//ijkf/4o9J/+OUUP/kmVn/5Z1f/+WcXf/kl1b/45JN/+KPSP/ij0j/4pBK/+KQSv/ij0j/4o9I/+OSTv/kmFf/5Zxe/+WdX//kmlr/45RQ/+KPSf/ijkf/4o5H/+ejaf/88ur////////////////////////////xyaj/5JlZ/+uygv/yzrD/9+LQ//rt4f/78ef/+/Dm//nq3P/228X/8MSe/+inb//jk1D/45RR/+ipc//wxqL/9t3I//rr3v/78Of/+/Ho//rt4f/34s//8s6u/+uxgP/lmVr/8s+x//////////////////////////////////z17v/559f//vv5/////////////////////////////////////////////fXv//TWu//12L///ffx/////////////////////////////////////////////vv4//nn1//99/H/////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=">


  <link href="/css/font.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.min.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.legenda.css" rel="stylesheet" type="text/css">
  <link href="/css/highlight.css" rel="stylesheet" type="text/css">
  <link href="/css/master.css" rel="stylesheet" type="text/css">
  <link href="/css/kube.demo.css" rel="stylesheet" type="text/css">

 <link href="/css/prettyprint.css" rel="stylesheet" type="text/css">
 <link href="/css/custom.css" rel="stylesheet" type="text/css">

  <script src="/js/jquery-2.1.4.min.js" type="text/javascript">
  </script>

  <script type="text/javascript" src="/js/tocbot.min.js"></script>
</head>


<body class="page-kube" onload="PR.prettyPrint()">
  <header> <div class="show-sm">
    <div id="nav-toggle-box">
      <div id="nav-toggle-brand">
        <a href="/">Copper</a>
      </div><a data-component="toggleme" data-target="#top" href="#" id="nav-toggle"><i class="kube-menu"></i></a>
    </div>
  </div>
  <div class="hide-sm" id="top">
    <div id="top-brand">
      <a href="/" title="home">
        <img src="/images/logo.svg" width="50px"/>
      </a>
    </div>
    <nav id="top-nav-main">
      <ul>
       
       
    <li><a href="/docs/" >Docs</a></li>
    
    <li><a href="/faq/" >Faq</a></li>
    
      </ul>
    </nav>
    <nav id="top-nav-extra">
      <ul>
        
      </ul>
    </nav>
  </div>
 </header>
  <main>
  <div id="main">
    <div id="hero">
      <h1> Getting Started </h1>
      <p class="hero-lead">
           Taking the first steps to validate your Kubernetes configuration files.
      </p>

    </div> 
    <div id="kube-component" class="content">
    

    

<h2 id="overview">Overview</h2>

<p>Copper validates configuration files using <strong>Rules</strong>. Rules are descriptions of what you would like to see (or don&rsquo;t see) in a configuration file. You can think of Rules like code unit tests, but for configuration.</p>

<h2 id="installation">Installation</h2>

<p>Copper is available as a Ruby gem. We recommend installig Copper using Rubygems.</p>

<p>To install Copper, use the following command:</p>

<p><kbd>
$ gem install copper
</kbd></p>

<p>You should now be able to run <kbd>$ copper version</kbd> successfully.</p>

<h2 id="copper-dsl">Copper DSL</h2>

<p>To define the rules, Copper uses a simple DLS. The Copper DSL looks like Javascript and is very easy to use. The Copper DSL has specific built-in features that are useful in writing rules for Kubernetes configuration files.</p>

<p>Rules are stored in files and each file can contain one of many rules. You can run a rule file against a configuration file using Copper CLI.</p>

<h2 id="writing-your-first-rule-file">Writing your first rule file</h2>

<p>Open up your favourite text editor and enter the following text into a new file called <code>my_rule.cop</code>:</p>

<pre class="prettyprint linenums">
rule ApiV1Only ensure {
    fetch("$.apiVersion").first == "v1" // we only allow the use of v1 API functions
}
</pre>

<h3 id="let-s-break-this-down">Let&rsquo;s break this down</h3>

<p><strong>Line 1</strong>: Define a rule called <code>ApiV1Only</code>. We want to make sure this rule is always applied and the validation fails if the rule is broken, we we make the rule an <code>ensure</code> one.</p>

<p><strong>Line 2</strong>: We use the <code>fetch</code> function to get the value of a node in the configuration file. <code>fetch</code> always returns an array of all found matches so we use <code>.first</code> to get the first one and compare it with <code>&quot;v1&quot;</code> string.</p>

<h2 id="validate-with-your-first-rule">Validate with your first rule</h2>

<p>Now that you have the rule to check for the API version, let&rsquo;s have a look at the configuraiton file. If you have a Kubernetes configuration file, you can use this rule against that (as all Kubernetes configuration files have the <code>apiVersion</code> attribute). Here is an example you can use:</p>

<pre class="prettyprint">
apiVersion: v1
kind: Service
metadata:
  namespace: foobar
  name: foo-svc
spec:
  type: NodePort
  ports:
  - port: 8080
    targetPort: 8090
</pre>

<p>Let&rsquo;s save this file as <code>service.yml</code> and validate it.</p>

<h3 id="using-copper-cli">Using Copper CLI</h3>

<p>With your rule <code>my_rule.cop</code> and configuration file <code>service.yml</code> at hand, hit the Copper CLI:</p>

<p><kbd>
$ copper check &ndash;rules my_rule.cop &ndash;file service.yml
</kbd></p>

<p>You should now see something like this (without the line numbers):</p>

<pre class="prettyprint linenums">
Validating part 0
    ApiV1Only - PASS
</pre>

<p><strong>Line 1</strong>: Copper CLI can read multipart YAML files, separated by <code>---</code>. <code>Validating part 0</code> means Copper is now validating the first part of the YAML configuration file. As our configuration file only has 1 part, we are only going to see <code>Validation part 0</code>.</p>

<p><strong>Line 2</strong>: This line shows that rule <code>ApiV1Only</code> has passed the validation successfully.</p>

<h4 id="now-let-s-break-the-test">Now let&rsquo;s break the test</h4>

<p>As with all good unit tests, you need make sure they work by breaking them!</p>

<pre class="prettyprint">
apiVersion: extensions/v1beta1
kind: Service
...
</pre>

<p>Now let&rsquo;s run the validation again:</p>

<pre class="prettyprint">
Validating part 0
    ApiV1Only - FAIL
</pre>

<h3 id="taking-it-one-step-further">Taking it one step further</h3>

<p>Now let&rsquo;s allow both <code>v1 and</code>extensions/v1beta<code>values as</code>apiVersion` in our configuration files, but nothing more:</p>

<pre class="prettyprint linenums">
rule ApiV1Only ensure {
    fetch("$.apiVersion").first == "v1" or // both v1
    fetch("$.apiVersion").first == "extensions/v1beta1" // and v1beta are allowed
}
</pre>

<p>Easy!</p>

<h2 id="congratulations">Congratulations!</h2>

<p>You successfully wrote your first Copper rule and validated a Kubernetes configuration file! Now let&rsquo;s explore the <a href="/docs/copper-dsl">power of Copper DSL</a>.</p>


    
    </div>
    </div>
</main>
  <footer></footer>


  <script src="/js/kube.js" type="text/javascript">
  </script>
  <script src="/js/kube.legenda.js" type="text/javascript">
  </script>
  <script src="/js/master.js" type="text/javascript">
  </script>
  <script src="/libraries/prettify/prettify.js"></script>
</body>

</html>
